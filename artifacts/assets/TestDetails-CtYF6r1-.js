import{ao as L,r,j as e,E as M,T as d,B as k,Q as z,G as n,M as H,m as j,F as N,D as G}from"./index-BBxgTFRz.js";import{I as $,S as O,M as u,T as Q,b as W,c as q,h as J,e as P,f as t,d as K,g as U,a as V}from"./TableRow-D1uAUnC5.js";import{R as X}from"./LeftOutlined-CbGDUdX1.js";function se(){const{msisdn:h}=L(),[f,D]=r.useState([]),[x,S]=r.useState([]),[y,p]=r.useState(!0),[b,T]=r.useState(null),[i,F]=r.useState(""),[l,C]=r.useState(""),[m,g]=r.useState(0),[c,_]=r.useState(5);r.useEffect(()=>{(async()=>{p(!0),T(null);try{const a=await V.get(`https://gatewayserver.smswithoutborders.com/v3/clients/${h}/tests`);D(a.data)}catch(a){console.error("Error fetching tests:",a),T("Failed to fetch test data.")}finally{p(!1)}})()},[h]),r.useEffect(()=>{let s=[...f];if(i&&(s=s.filter(a=>a.status===i)),l){const a=new Date(l);a.setHours(0,0,0,0),s=s.filter(B=>{const v=new Date(B.start_time*1e3);return v.setHours(0,0,0,0),v.getTime()===a.getTime()})}S(s),g(0)},[f,i,l]);const w=(s,a)=>{g(a)},I=s=>{_(parseInt(s.target.value,10)),g(0)},R=s=>{F(s.target.value)},E=s=>{C(s.target.value)},A=x.slice(m*c,m*c+c);if(y)return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px"},children:e.jsx(M,{})});if(b)return e.jsx(d,{color:"error",align:"center",children:b});const o=s=>s?new Date(s*1e3).toLocaleString():"N/A";return e.jsxs("div",{children:[e.jsxs(d,{variant:"h5",gutterBottom:!0,children:["Tests for MSISDN: ",h]}),e.jsxs(k,{component:z,to:"/reliability",variant:"text",sx:{mb:2},children:[e.jsx(X,{})," Back"]}),e.jsx(n,{size:{xs:12},children:e.jsx(H,{sx:{mt:1},content:!1,children:e.jsxs(j,{sx:{p:3},children:[e.jsx(d,{variant:"h6",color:"text.secondary",sx:{mb:2},children:"Filters"}),e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,size:{xs:12,md:6,lg:3},children:e.jsxs(N,{fullWidth:!0,children:[e.jsx($,{id:"status-filter-label",children:"Status"}),e.jsxs(O,{labelId:"status-filter-label",id:"status-filter",value:i,onChange:R,children:[e.jsx(u,{value:"",children:"All"}),e.jsx(u,{value:"pending",children:"Pending"}),e.jsx(u,{value:"success",children:"Success"}),e.jsx(u,{value:"timedout",children:"Timedout"})]})]})}),e.jsx(n,{item:!0,size:{xs:12,md:6,lg:3},children:e.jsx(Q,{id:"date-filter",label:"Filter by Date",type:"date",value:l,onChange:E,InputLabelProps:{shrink:!0}})})]})]})})}),e.jsx(n,{size:{xs:12},sx:{mt:2},children:x.length>0?e.jsxs(W,{component:G,children:[e.jsxs(q,{children:[e.jsx(J,{children:e.jsxs(P,{children:[e.jsx(t,{children:"ID"}),e.jsx(t,{children:"start_time"}),e.jsx(t,{children:"sms_received_time"}),e.jsx(t,{children:"sms_routed_time"}),e.jsx(t,{children:"sms_sent_time"}),e.jsx(t,{children:"Status"})]})}),e.jsx(K,{children:A.map(s=>e.jsxs(P,{children:[e.jsx(t,{children:s.id}),e.jsx(t,{children:o(s.start_time)}),e.jsx(t,{children:o(s.sms_received_time)}),e.jsx(t,{children:o(s.sms_routed_time)}),e.jsx(t,{children:o(s.sms_sent_time)}),e.jsx(t,{children:e.jsxs(j,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(j,{sx:{width:10,height:10,borderRadius:"50%",backgroundColor:s.status==="success"?"#52C41A":s.status==="timedout"?"#FF4D4F":s.status==="pending"?"#FAAD14":"grey",mr:1}}),s.status]})})]},s.id))})]}),e.jsx(U,{rowsPerPageOptions:[5,10,25],component:"div",count:x.length,rowsPerPage:c,page:m,onPageChange:w,onRowsPerPageChange:I})]}):e.jsx(d,{children:"No tests found matching your criteria."})})]})}export{se as default};
